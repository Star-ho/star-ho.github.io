<!doctype html><html lang=ko-kr dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="가상쓰레드, 리액티브 스트림즈, 코루틴 이 세가지 프로젝트는 모두 Blocking I/O로 인한 병목을 줄이기 위해 nonBlocking I/O를 사용할 목적으로 쓰이고 있습니다.\n기존에는 리액티브 스트림즈, 코루틴으로 nonBlocking I/O를 사용했다면, 작년 가상쓰레드가 나온 이후, 과연 어떻게될 지에 대해 개인적인 의견 및 정보들을 작성하려 합니다.\n"><title>15 - 가상스레드 vs 리액티브 스트림즈 vs 코루틴</title>
<link rel=canonical href=https://sungho94.me/p/15-%EA%B0%80%EC%83%81%EC%8A%A4%EB%A0%88%EB%93%9C-vs-%EB%A6%AC%EC%95%A1%ED%8B%B0%EB%B8%8C-%EC%8A%A4%ED%8A%B8%EB%A6%BC%EC%A6%88-vs-%EC%BD%94%EB%A3%A8%ED%8B%B4/><link rel=stylesheet href=/scss/style.min.0304c6baf04e01a8fe70693791cb744d56a3578a3120a8796cefc66825aa39c7.css><meta property='og:title' content="15 - 가상스레드 vs 리액티브 스트림즈 vs 코루틴"><meta property='og:description' content="가상쓰레드, 리액티브 스트림즈, 코루틴 이 세가지 프로젝트는 모두 Blocking I/O로 인한 병목을 줄이기 위해 nonBlocking I/O를 사용할 목적으로 쓰이고 있습니다.\n기존에는 리액티브 스트림즈, 코루틴으로 nonBlocking I/O를 사용했다면, 작년 가상쓰레드가 나온 이후, 과연 어떻게될 지에 대해 개인적인 의견 및 정보들을 작성하려 합니다.\n"><meta property='og:url' content='https://sungho94.me/p/15-%EA%B0%80%EC%83%81%EC%8A%A4%EB%A0%88%EB%93%9C-vs-%EB%A6%AC%EC%95%A1%ED%8B%B0%EB%B8%8C-%EC%8A%A4%ED%8A%B8%EB%A6%BC%EC%A6%88-vs-%EC%BD%94%EB%A3%A8%ED%8B%B4/'><meta property='og:site_name' content="Sungho's Dev BLog"><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='Server-History'><meta property='article:tag' content='hugo_blog'><meta property='article:tag' content='virtual-thread'><meta property='article:tag' content='Reactive'><meta property='article:tag' content='Server'><meta property='article:published_time' content='2024-03-31T22:41:00+00:00'><meta property='article:modified_time' content='2024-09-22T07:08:20+00:00'><meta name=twitter:title content="15 - 가상스레드 vs 리액티브 스트림즈 vs 코루틴"><meta name=twitter:description content="가상쓰레드, 리액티브 스트림즈, 코루틴 이 세가지 프로젝트는 모두 Blocking I/O로 인한 병목을 줄이기 위해 nonBlocking I/O를 사용할 목적으로 쓰이고 있습니다.\n기존에는 리액티브 스트림즈, 코루틴으로 nonBlocking I/O를 사용했다면, 작년 가상쓰레드가 나온 이후, 과연 어떻게될 지에 대해 개인적인 의견 및 정보들을 작성하려 합니다.\n"><link rel="shortcut icon" href=/favicon.png><script async src="https://www.googletagmanager.com/gtag/js?id=G-PTKY5BPR7H"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-PTKY5BPR7H")}</script></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="메뉴 여닫기">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu1582294339771580780.png width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>🍥</span></figure><div class=site-meta><h1 class=site-name><a href=/>Sungho's Dev BLog</a></h1><h2 class=site-description>백엔드 개발자 황성호입니다.</h2></div></header><ol class=menu-social><li><a href=https://github.com/Star-ho target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://www.linkedin.com/in/starho/ target=_blank title=LinkedIn rel=me><svg fill="#000" width="800" height="800" viewBox="0 0 24 24"><path d="M6.975 20.667H3.117V9.059H6.975zM5.072 3.462a2.011 2.011.0 10-.051 4.012h.026a2.012 2.012.0 10.025-4.012zM9.111 20.667h3.858V14.185a2.639 2.639.0 01.127-.941 2.111 2.111.0 011.98-1.411c1.4.0 1.955 1.064 1.955 2.625v6.209h3.858V14.011c0-3.565-1.9-5.225-4.442-5.225A3.828 3.828.0 0012.97 10.7V9.059H9.111c.051 1.089.0 11.609.0 11.609z"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/links/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Links</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>다크 모드</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">목차</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#리액티브-스트림즈httpswwwreactive-streamsorg><a href=https://www.reactive-streams.org/>리액티브 스트림즈</a></a></li><li><a href=#코루틴httpsgithubcomkotlinkeepblobmasterproposalscoroutinesmd><a href=https://github.com/Kotlin/KEEP/blob/master/proposals/coroutines.md>코루틴</a></a></li><li><a href=#가상-스레드httpsopenjdkorgjeps444><a href=https://openjdk.org/jeps/444>가상 스레드</a></a></li><li><a href=#결론>결론</a></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/server-history-series/>Server-History-Series</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/15-%EA%B0%80%EC%83%81%EC%8A%A4%EB%A0%88%EB%93%9C-vs-%EB%A6%AC%EC%95%A1%ED%8B%B0%EB%B8%8C-%EC%8A%A4%ED%8A%B8%EB%A6%BC%EC%A6%88-vs-%EC%BD%94%EB%A3%A8%ED%8B%B4/>15 - 가상스레드 vs 리액티브 스트림즈 vs 코루틴</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Mar 31, 2024</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>3 분 정도</time></div></footer></div></header><section class=article-content><p>가상쓰레드, 리액티브 스트림즈, 코루틴 이 세가지 프로젝트는 모두 Blocking I/O로 인한 병목을 줄이기 위해 nonBlocking I/O를 사용할 목적으로 쓰이고 있습니다.</p><p>기존에는 리액티브 스트림즈, 코루틴으로 nonBlocking I/O를 사용했다면, 작년 가상쓰레드가 나온 이후, 과연 어떻게될 지에 대해 개인적인 의견 및 정보들을 작성하려 합니다.</p><p>우선 세가지 프로젝트의 목표에 대해 이야기 하려합니다.</p><h2 id=리액티브-스트림즈httpswwwreactive-streamsorg><a class=link href=https://www.reactive-streams.org/ target=_blank rel=noopener>리액티브 스트림즈</a></h2><p><code>The main goal of Reactive Streams is to govern the exchange of stream data across an asynchronous boundary—think passing elements on to another thread or thread-pool—while ensuring that the receiving side is not forced to buffer arbitrary amounts of data. In other words, back pressure is an integral part of this model in order to allow the queues which mediate between threads to be bounded. The benefits of asynchronous processing would be negated if the communication of back pressure were synchronous (see also the [Reactive Manifesto](http://reactivemanifesto.org/)), therefore care has to be taken to mandate fully non-blocking and asynchronous behavior of all aspects of a Reactive Streams implementation.</code></p><p>간단히 요약해보자면<br><code>비동기 뿐만이 아닌, 쓰레드간 element들을 교환하여 백프레셔를 지원하여 수신측에서 리소스를 지원한다</code><br>입니다</p><p>리액티브 스트림즈트는 비동기 뿐만이 아닌, 배압까지 신경쓰고 있는 것을 알 수 있습니다</p><h2 id=코루틴httpsgithubcomkotlinkeepblobmasterproposalscoroutinesmd><a class=link href=https://github.com/Kotlin/KEEP/blob/master/proposals/coroutines.md target=_blank rel=noopener>코루틴</a></h2><p><code>No dependency on a particular implementation of Futures or other such rich library; </code>Cover equally the &ldquo;async/await&rdquo; use case and &ldquo;generator blocks&rdquo;;<code> </code>Make it possible to utilize Kotlin coroutines as wrappers for different existing asynchronous APIs (such as Java NIO, different implementations of Futures, etc).`</p><p>코루틴의 목표는<code>Futures와 다른 라이브러리 의존 없이, 비동기 api의 래퍼를 제공</code>하는것 입니다</p><h2 id=가상-스레드httpsopenjdkorgjeps444><a class=link href=https://openjdk.org/jeps/444 target=_blank rel=noopener>가상 스레드</a></h2><p><code>Enable server applications written in the simple thread-per-request style to scale with near-optimal hardware utilization.</code><br><code>Enable existing code that uses the java.lang.Thread API to adopt virtual threads with minimal change.</code><br><code>Enable easy troubleshooting, debugging, and profiling of virtual threads with existing JDK tools.</code></p><p>가상스레드의 목표는 <code>최소한의 변경으로, 현재 서버 애플리케이션이 작성된 요청당 스레드 모델의 최적화된 하드웨어 사용</code>이라는 것을 알 수 있습니다.<br><br>추가로 Improving scalability with the asynchronous style을 살펴보면 reactive에 대한 내용이 더 나온다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>Some</span> <span class=n>developers</span> <span class=n>wishing</span> <span class=n>to</span> <span class=n>utilize</span> <span class=n>hardware</span> <span class=n>to</span> <span class=n>its</span> <span class=n>fullest</span> <span class=n>have</span> <span class=n>given</span> <span class=n>up</span> <span class=n>the</span> <span class=n>thread</span><span class=o>-</span><span class=n>per</span><span class=o>-</span><span class=n>request</span> <span class=n>style</span> <span class=ow>in</span> <span class=n>favor</span> <span class=n>of</span> <span class=n>a</span> <span class=n>thread</span><span class=o>-</span><span class=n>sharing</span> <span class=n>style</span><span class=o>.</span> <span class=n>Instead</span> <span class=n>of</span> <span class=n>handling</span> <span class=n>a</span> <span class=n>request</span> <span class=n>on</span> <span class=n>one</span> <span class=n>thread</span> <span class=n>from</span> <span class=n>start</span> <span class=n>to</span> <span class=n>finish</span><span class=p>,</span> <span class=n>request</span><span class=o>-</span><span class=n>handling</span> <span class=n>code</span> <span class=n>returns</span> <span class=n>its</span> <span class=n>thread</span> <span class=n>to</span> <span class=n>a</span> <span class=n>pool</span> <span class=n>when</span> <span class=n>it</span> <span class=n>waits</span> <span class=k>for</span> <span class=n>another</span> <span class=n>I</span><span class=o>/</span><span class=n>O</span> <span class=n>operation</span> <span class=n>to</span> <span class=n>complete</span> <span class=n>so</span> <span class=n>that</span> <span class=n>the</span> <span class=n>thread</span> <span class=n>can</span> <span class=n>service</span> <span class=n>other</span> <span class=n>requests</span><span class=o>.</span> <span class=n>This</span> <span class=n>fine</span><span class=o>-</span><span class=n>grained</span> <span class=n>sharing</span> <span class=n>of</span> <span class=n>threads</span> <span class=err>—</span> <span class=ow>in</span> <span class=n>which</span> <span class=n>code</span> <span class=n>holds</span> <span class=n>on</span> <span class=n>to</span> <span class=n>a</span> <span class=n>thread</span> <span class=n>only</span> <span class=k>while</span> <span class=n>it</span> <span class=n>performs</span> <span class=n>calculations</span><span class=p>,</span> <span class=ow>not</span> <span class=k>while</span> <span class=n>it</span> <span class=n>waits</span> <span class=k>for</span> <span class=n>I</span><span class=o>/</span><span class=n>O</span> <span class=err>—</span> <span class=n>allows</span> <span class=n>a</span> <span class=n>high</span> <span class=n>number</span> <span class=n>of</span> <span class=n>concurrent</span> <span class=n>operations</span> <span class=n>without</span> <span class=n>consuming</span> <span class=n>a</span> <span class=n>high</span> <span class=n>number</span> <span class=n>of</span> <span class=n>threads</span><span class=o>.</span> <span class=n>While</span> <span class=n>it</span> <span class=n>removes</span> <span class=n>the</span> <span class=n>limitation</span> <span class=n>on</span> <span class=n>throughput</span> <span class=n>imposed</span> <span class=n>by</span> <span class=n>the</span> <span class=n>scarcity</span> <span class=n>of</span> <span class=ne>OS</span> <span class=n>threads</span><span class=p>,</span> <span class=n>it</span> <span class=n>comes</span> <span class=n>at</span> <span class=n>a</span> <span class=n>high</span> <span class=n>price</span><span class=p>:</span> <span class=n>It</span> <span class=n>requires</span> <span class=n>what</span> <span class=n>is</span> <span class=n>known</span> <span class=n>as</span> <span class=n>an</span> <span class=n>_asynchronous_</span> <span class=n>programming</span> <span class=n>style</span><span class=p>,</span> <span class=n>employing</span> <span class=n>a</span> <span class=n>separate</span> <span class=n>set</span> <span class=n>of</span> <span class=n>I</span><span class=o>/</span><span class=n>O</span> <span class=n>methods</span> <span class=n>that</span> <span class=k>do</span> <span class=ow>not</span> <span class=n>wait</span> <span class=k>for</span> <span class=n>I</span><span class=o>/</span><span class=n>O</span> <span class=n>operations</span> <span class=n>to</span> <span class=n>complete</span> <span class=n>but</span> <span class=n>rather</span><span class=p>,</span> <span class=n>later</span> <span class=n>on</span><span class=p>,</span> <span class=k>signal</span> <span class=n>their</span> <span class=n>completion</span> <span class=n>to</span> <span class=n>a</span> <span class=n>callback</span><span class=o>.</span> <span class=n>Without</span> <span class=n>a</span> <span class=n>dedicated</span> <span class=n>thread</span><span class=p>,</span> <span class=n>developers</span> <span class=n>must</span> <span class=k>break</span> <span class=n>down</span> <span class=n>their</span> <span class=n>request</span><span class=o>-</span><span class=n>handling</span> <span class=n>logic</span> <span class=n>into</span> <span class=n>small</span> <span class=n>stages</span><span class=p>,</span> <span class=n>typically</span> <span class=n>written</span> <span class=n>as</span> <span class=n>lambda</span> <span class=n>expressions</span><span class=p>,</span> <span class=ow>and</span> <span class=n>then</span> <span class=n>compose</span> <span class=n>them</span> <span class=n>into</span> <span class=n>a</span> <span class=n>sequential</span> <span class=n>pipeline</span> <span class=n>with</span> <span class=n>an</span> <span class=n>API</span> <span class=p>(</span><span class=n>see</span> <span class=p>[</span><span class=n>CompletableFuture</span><span class=p>](</span><span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>docs</span><span class=o>.</span><span class=n>oracle</span><span class=o>.</span><span class=n>com</span><span class=o>/</span><span class=n>en</span><span class=o>/</span><span class=n>java</span><span class=o>/</span><span class=n>javase</span><span class=o>/</span><span class=mi>21</span><span class=o>/</span><span class=n>docs</span><span class=o>/</span><span class=n>api</span><span class=o>/</span><span class=n>java</span><span class=o>.</span><span class=n>base</span><span class=o>/</span><span class=n>java</span><span class=o>/</span><span class=n>util</span><span class=o>/</span><span class=n>concurrent</span><span class=o>/</span><span class=n>CompletableFuture</span><span class=o>.</span><span class=n>html</span><span class=p>),</span> <span class=k>for</span> <span class=n>example</span><span class=p>,</span> <span class=ow>or</span> <span class=n>so</span><span class=o>-</span><span class=n>called</span> <span class=s2>&#34;reactive&#34;</span> <span class=n>frameworks</span><span class=p>)</span><span class=o>.</span> <span class=n>They</span> <span class=n>thus</span> <span class=n>forsake</span> <span class=n>the</span> <span class=n>language</span><span class=s1>&#39;s basic sequential composition operators, such as loops and `try/catch` blocks.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=n>the</span> <span class=n>asynchronous</span> <span class=n>style</span><span class=p>,</span> <span class=n>each</span> <span class=n>stage</span> <span class=n>of</span> <span class=n>a</span> <span class=n>request</span> <span class=n>might</span> <span class=n>execute</span> <span class=n>on</span> <span class=n>a</span> <span class=n>different</span> <span class=n>thread</span><span class=p>,</span> <span class=ow>and</span> <span class=n>every</span> <span class=n>thread</span> <span class=n>runs</span> <span class=n>stages</span> <span class=n>belonging</span> <span class=n>to</span> <span class=n>different</span> <span class=n>requests</span> <span class=ow>in</span> <span class=n>an</span> <span class=n>interleaved</span> <span class=n>fashion</span><span class=o>.</span> <span class=n>This</span> <span class=n>has</span> <span class=n>deep</span> <span class=n>implications</span> <span class=k>for</span> <span class=n>understanding</span> <span class=n>program</span> <span class=n>behavior</span><span class=p>:</span> <span class=n>Stack</span> <span class=n>traces</span> <span class=n>provide</span> <span class=n>no</span> <span class=n>usable</span> <span class=n>context</span><span class=p>,</span> <span class=n>debuggers</span> <span class=n>cannot</span> <span class=n>step</span> <span class=n>through</span> <span class=n>request</span><span class=o>-</span><span class=n>handling</span> <span class=n>logic</span><span class=p>,</span> <span class=ow>and</span> <span class=n>profilers</span> <span class=n>cannot</span> <span class=n>associate</span> <span class=n>an</span> <span class=n>operation</span><span class=s1>&#39;s cost with its caller. Composing lambda expressions is manageable when using Java&#39;</span><span class=n>s</span> <span class=p>[</span><span class=n>stream</span> <span class=n>API</span><span class=p>](</span><span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>docs</span><span class=o>.</span><span class=n>oracle</span><span class=o>.</span><span class=n>com</span><span class=o>/</span><span class=n>en</span><span class=o>/</span><span class=n>java</span><span class=o>/</span><span class=n>javase</span><span class=o>/</span><span class=mi>21</span><span class=o>/</span><span class=n>docs</span><span class=o>/</span><span class=n>api</span><span class=o>/</span><span class=n>java</span><span class=o>.</span><span class=n>base</span><span class=o>/</span><span class=n>java</span><span class=o>/</span><span class=n>util</span><span class=o>/</span><span class=n>stream</span><span class=o>/</span><span class=n>package</span><span class=o>-</span><span class=n>summary</span><span class=o>.</span><span class=n>html</span><span class=p>)</span> <span class=n>to</span> <span class=n>process</span> <span class=n>data</span> <span class=ow>in</span> <span class=n>a</span> <span class=n>short</span> <span class=n>pipeline</span> <span class=n>but</span> <span class=n>problematic</span> <span class=n>when</span> <span class=n>all</span> <span class=n>of</span> <span class=n>the</span> <span class=n>request</span><span class=o>-</span><span class=n>handling</span> <span class=n>code</span> <span class=ow>in</span> <span class=n>an</span> <span class=n>application</span> <span class=n>must</span> <span class=n>be</span> <span class=n>written</span> <span class=ow>in</span> <span class=n>this</span> <span class=n>way</span><span class=o>.</span> <span class=n>This</span> <span class=n>programming</span> <span class=n>style</span> <span class=n>is</span> <span class=n>at</span> <span class=n>odds</span> <span class=n>with</span> <span class=n>the</span> <span class=n>Java</span> <span class=n>Platform</span> <span class=n>because</span> <span class=n>the</span> <span class=n>application</span><span class=s1>&#39;s unit of concurrency — the asynchronous pipeline — is no longer the platform&#39;</span><span class=n>s</span> <span class=n>unit</span> <span class=n>of</span> <span class=n>concurrency</span><span class=o>.</span>
</span></span></code></pre></td></tr></table></div></div><p>리액티브 스타일의 어려운점(코드 스타일, 스택 트레이스, 디버깅 등)을 언급하는 부분이 있다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Typically, a virtual thread will unmount when it blocks on I/O or some other blocking operation in the JDK, such as `BlockingQueue.take()`. When the blocking operation is ready to complete (e.g., bytes have been received on a socket), it submits the virtual thread back to the scheduler, which will mount the virtual thread on a carrier to resume execution.
</span></span></code></pre></td></tr></table></div></div><p>추가로 virtual Thread는 Blocking작업을 해당 스레드 unmount를 통해 Blocking을 회피할 수 있는것도 알 수 있다.</p><h2 id=결론>결론</h2><p>이를보면 가상 스레드가 리액티브 스트림즈를 대체하는 Blocking I/O로 인한 병목을 줄이는 기능을 하지않을까 싶다.</p><p>java reactor에서 virtual thread를 사용하는 scheduler를 추가하며 vitual thread를 지원한다.<br>지원한다고 해도 reactive streams의 단점이 뚜렸다하기에 reactive streams의 추가적인 기능인 배압을 사용하지 않는 이상, virtual thread를 사용하는게 더 나을거란 생각이다.</p><p>coroutine에서도 가상스레드를 지원하지만, Coroutine 또한 코드의 변경이 필요하기에, 가상스레드가 더 나을거라 생각된다</p><p>개인적으로 리액티브 스트림즈 구현체인 리액터를 사용하면서 어려운점이 많았기에 얼른 가상스레드를 사용하고 싶다.<br>하지만 가상스레드가 나왔지만, 데이터베이스 드라이버 같은 외부 라이브러리의 수정이 완성되지 않아 업무 프로젝트에는 사용하기 어려운점이 아쉽다.</p><p><a class=link href=https://www.reactive-streams.org/ target=_blank rel=noopener>https://www.reactive-streams.org/</a><br><a class=link href=https://openjdk.org/jeps/444 target=_blank rel=noopener>https://openjdk.org/jeps/444</a><br><a class=link href=https://github.com/Kotlin/KEEP/blob/master/proposals/coroutines.md target=_blank rel=noopener>https://github.com/Kotlin/KEEP/blob/master/proposals/coroutines.md</a><br><a class=link href=https://blog.honeybomb.kr/9 target=_blank rel=noopener>https://blog.honeybomb.kr/9</a><br><a class=link href=https://perfectacle.github.io/2023/07/10/java-virtual-thread-vs-kotlin-coroutine/ target=_blank rel=noopener>https://perfectacle.github.io/2023/07/10/java-virtual-thread-vs-kotlin-coroutine/</a></p></section><footer class=article-footer><section class=article-tags><a href=/tags/server-history/>Server-History</a>
<a href=/tags/hugo_blog/>Hugo_blog</a>
<a href=/tags/virtual-thread/>Virtual-Thread</a>
<a href=/tags/reactive/>Reactive</a>
<a href=/tags/server/>Server</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section><section class=article-lastmod><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<span>마지막 수정: Sep 22, 2024 07:08 UTC</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>관련 글</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/p/11-reactor-java2/><div class=article-details><h2 class=article-title>11-Reactor Java(2)</h2></div></a></article><article><a href=/p/10-reactor-java1/><div class=article-details><h2 class=article-title>10-Reactor Java(1)</h2></div></a></article><article><a href=/p/13-virtual-thread-1/><div class=article-details><h2 class=article-title>13-Virtual Thread 1</h2></div></a></article><article><a href=/p/12-reactor-schedulerboundedelasticscheduler/><div class=article-details><h2 class=article-title>12-Reactor Scheduler(BoundedElasticScheduler)</h2></div></a></article><article><a href=/p/9-reactive-streams/><div class=article-details><h2 class=article-title>9-Reactive Streams</h2></div></a></article></div></div></aside><script src=https://utteranc.es/client.js repo=Star-ho/star-ho.github.io issue-term=pathname label=Comments crossorigin=anonymous async></script><style>.utterances{max-width:unset}</style><script>let utterancesLoaded=!1;function setUtterancesTheme(e){let t=document.querySelector(".utterances iframe");t&&t.contentWindow.postMessage({type:"set-theme",theme:`github-${e}`},"https://utteranc.es")}addEventListener("message",e=>{if(e.origin!=="https://utteranc.es")return;utterancesLoaded=!0,setUtterancesTheme(document.documentElement.dataset.scheme)}),window.addEventListener("onColorSchemeChange",e=>{if(!utterancesLoaded)return;setUtterancesTheme(e.detail)})</script><footer class=site-footer><section class=copyright>&copy;
2020 -
2024 Sungho's Dev BLog</section><section class=powerby><a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a>로 만듦<br><a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a>의 <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.26.0>Stack</a></b> 테마 사용 중</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>