<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>JVM-Option on Sungho's Dev BLog</title><link>https://sungho94.me/tags/jvm-option/</link><description>Recent content in JVM-Option on Sungho's Dev BLog</description><generator>Hugo -- gohugo.io</generator><language>ko-kr</language><lastBuildDate>Tue, 14 Nov 2023 11:26:23 +0000</lastBuildDate><atom:link href="https://sungho94.me/tags/jvm-option/index.xml" rel="self" type="application/rss+xml"/><item><title>jvm option for Container</title><link>https://sungho94.me/p/jvm-option-for-container/</link><pubDate>Tue, 14 Nov 2023 11:26:23 +0000</pubDate><guid>https://sungho94.me/p/jvm-option-for-container/</guid><description>&lt;h3 id="현재-옵션-확인">현재 옵션 확인
&lt;/h3>&lt;ul>
&lt;li>java -XX:+PrintFlagsFinal -version 2&amp;gt;&amp;amp;1 | grep -i -E &amp;lsquo;heapsize|metaspace|version&amp;rsquo;&lt;/li>
&lt;/ul>
&lt;h3 id="memory">Memory
&lt;/h3>&lt;ul>
&lt;li>고정값으로 설정
&lt;ul>
&lt;li>-Xmx(ex -Xmx4g)
&lt;ul>
&lt;li>최대값&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>-Xms(ex -Xms500m)
&lt;ul>
&lt;li>최소값&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>비율로 설정
&lt;ul>
&lt;li>-XX:MaxRAMPercentage(-XX:MaxRAMPercentage=75),
&lt;ul>
&lt;li>최대값&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>-XX:InitialRAMPercentage(-XX:InitialRAMPercentage=75)
&lt;ul>
&lt;li>최소값&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>메모리 설정시 팁!
&lt;ul>
&lt;li>container메모리와 heap은 같은 사이즈로 가면 안됨
&lt;ul>
&lt;li>java에는 heap말고 non-heap도 있기때문&lt;/li>
&lt;li>힙 공간 외에도 Java 스레드, 가비지 컬렉션, 메타스페이스, 네이티브 메모리, 소켓 버퍼를 위한 공간이 필요하기 때문&lt;/li>
&lt;li>컨테이너 메모리와 같은 크기로 했을 때 컨테이너도 crash 발생하기 때문에 oom 후처리가 안됨&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>percentage로 75%정도 권장
&lt;ul>
&lt;li>&lt;a class="link" href="https://learn.microsoft.com/en-us/azure/developer/java/containers/overview" target="_blank" rel="noopener"
>ms홈페이지 참고&lt;/a>&lt;/li>
&lt;li>물론 절대적인건 아님&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>하나의 컨테이너에 하나의 어플리케이션만 돌아갈떄 min size와 max size를 같게 설정
&lt;ul>
&lt;li>메모리가 부족이 발생하면 os에 메모리를 더 달라고 요청하는데, 어차피 하나의 컨테이너에 하나의 프로세스만 돌아가는데 굳이 필요없는 요청을 늘릴 필요가없음&lt;/li>
&lt;li>gc가 더 자주 실행됨&lt;/li>
&lt;li>하나의 컨테이너에서 하나의 프로세스만 돌기 때문에 경쟁이 필요가 없음&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="oom-처리">OOM 처리
&lt;/h3>&lt;ul>
&lt;li>-XX:+HeapDumpOnOutOfMemoryError
&lt;ul>
&lt;li>OOM이 발생하면 heap dump를 생성&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>-XX:HeapDumpPath=/var/log
&lt;ul>
&lt;li>힙 덤프 생성 위치 설정&lt;/li>
&lt;li>위의 아래에 .hprof파일 생성됨&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>MaxRAMFraction&lt;/p>
&lt;ul>
&lt;li>deprecated된 옵션&lt;/li>
&lt;li>max heap memory를 설정하는 다른 방법&lt;/li>
&lt;/ul>
&lt;/blockquote>
&lt;blockquote>
&lt;p>InitialRAMPercentage, MinRAMPercentage관련한 글&lt;br>
&lt;a class="link" href="https://blog.gceasy.io/2020/11/05/difference-between-initialrampercentage-minrampercentage-maxrampercentage/" target="_blank" rel="noopener"
>https://blog.gceasy.io/2020/11/05/difference-between-initialrampercentage-minrampercentage-maxrampercentage/&lt;/a>&lt;br>
&lt;a class="link" href="https://blog.ycrash.io/2020/11/23/best-practices-java-memory-arguments-for-containers/" target="_blank" rel="noopener"
>https://blog.ycrash.io/2020/11/23/best-practices-java-memory-arguments-for-containers/&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>#JVM-option&lt;/p>
&lt;p>&lt;a class="link" href="https://docs.oracle.com/en/java/javase/17/docs/specs/man/java.html" target="_blank" rel="noopener"
>https://docs.oracle.com/en/java/javase/17/docs/specs/man/java.html&lt;/a>&lt;br>
&lt;a class="link" href="https://www.merikan.com/2019/04/jvm-in-a-container/" target="_blank" rel="noopener"
>https://www.merikan.com/2019/04/jvm-in-a-container/&lt;/a>&lt;br>
&lt;a class="link" href="https://learn.microsoft.com/en-us/azure/developer/java/containers/overview" target="_blank" rel="noopener"
>https://learn.microsoft.com/en-us/azure/developer/java/containers/overview&lt;/a>&lt;br>
&lt;a class="link" href="https://stackoverflow.com/questions/43651167/is-there-any-advantage-in-setting-xms-and-xmx-to-the-same-value" target="_blank" rel="noopener"
>https://stackoverflow.com/questions/43651167/is-there-any-advantage-in-setting-xms-and-xmx-to-the-same-value&lt;/a>&lt;br>
&lt;a class="link" href="https://developer.jboss.org/thread/149559" target="_blank" rel="noopener"
>https://developer.jboss.org/thread/149559&lt;/a>&lt;br>
&lt;a class="link" href="https://www.codementor.io/@suryab/outofmemoryerror-related-jvm-arguments-w6e4vgipt" target="_blank" rel="noopener"
>https://www.codementor.io/@suryab/outofmemoryerror-related-jvm-arguments-w6e4vgipt&lt;/a>&lt;br>
&lt;a class="link" href="https://medium.com/nordnet-tech/setting-java-heap-size-inside-a-docker-container-b5a4d06d2f46" target="_blank" rel="noopener"
>https://medium.com/nordnet-tech/setting-java-heap-size-inside-a-docker-container-b5a4d06d2f46&lt;/a>&lt;br>
&lt;a class="link" href="https://dzone.com/articles/best-practices-java-memory-arguments-for-container" target="_blank" rel="noopener"
>https://dzone.com/articles/best-practices-java-memory-arguments-for-container&lt;/a>&lt;br>
&lt;a class="link" href="https://docs.oracle.com/en/java/javase/17/docs/specs/man/java.html#overview-of-java-options" target="_blank" rel="noopener"
>https://docs.oracle.com/en/java/javase/17/docs/specs/man/java.html#overview-of-java-options&lt;/a>&lt;br>
&lt;a class="link" href="https://d2.naver.com/helloworld/37111" target="_blank" rel="noopener"
>https://d2.naver.com/helloworld/37111&lt;/a>&lt;/p></description></item></channel></rss>